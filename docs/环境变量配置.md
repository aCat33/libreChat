# 环境变量配置说明

## 快速开始

要在千问和 DeepSeek 之间切换，您需要配置相应的 API 密钥。

### 步骤 1：创建 .env 文件

如果项目根目录下还没有 `.env` 文件，请创建一个：

```bash
# 在项目根目录（d:\work\librechat）创建 .env 文件
# 可以复制 .env.example 作为模板
```

### 步骤 2：添加 API 密钥

在 `.env` 文件中添加以下内容：

```bash
# DeepSeek API 密钥（如果已有，保持不变）
DEEPSEEK_API_KEY=your_deepseek_api_key_here

# 千问 API 密钥（新增）
QWEN_CUSTOM_API_KEY=sk-z1pdeRmDlNG5c
```

### 步骤 3：重启服务

```bash
# 停止当前运行的服务（按 Ctrl+C）
# 然后重新启动
npm run backend:dev
```

## 配置已完成

现在您的 LibreChat 已经同时配置了 DeepSeek 和千问两个端点！

### 在 UI 中切换使用

1. 打开 LibreChat 网页界面
2. 在对话界面顶部，您会看到端点选择器
3. 点击选择 **"DeepSeek"** 或 **"千问"**
4. 选择端点后，可以进一步选择具体的模型：
   - **DeepSeek**：`deepseek-chat`、`deepseek-coder`
   - **千问**：`Qwen3-Thinking`、`Qwen2.5-72B-Instruct` 等

## 无需修改代码

✅ 您**不需要修改任何代码文件**！

配置文件方式的优势：
- 所有配置都在 `librechat.yaml` 和 `.env` 中完成
- 可以在 UI 界面随时切换模型
- 支持同时配置多个 LLM 提供商
- 无需重新编译或修改源代码

## 验证配置

### 检查配置文件

1. **librechat.yaml** - 应该包含两个端点配置：
   ```yaml
   endpoints:
     custom:
       - name: "DeepSeek"
         # ...
       - name: "Qwen"
         # ...
   ```

2. **.env** - 应该包含两个 API 密钥：
   ```bash
   DEEPSEEK_API_KEY=...
   QWEN_CUSTOM_API_KEY=...
   ```

### 启动测试

1. 启动后端服务：
   ```bash
   npm run backend:dev
   ```

2. 检查控制台输出，确保没有配置错误

3. 打开浏览器访问 LibreChat

4. 在模型选择器中应该能看到 "DeepSeek" 和 "千问" 两个选项

## 故障排查

### 问题：看不到千问端点

**可能原因：**
- `.env` 文件中没有 `QWEN_CUSTOM_API_KEY`
- 服务没有重启

**解决方案：**
1. 检查 `.env` 文件，确保包含 `QWEN_CUSTOM_API_KEY=sk-z1pdeRmDlNG5c`
2. 完全停止服务（Ctrl+C）
3. 重新启动：`npm run backend:dev`

### 问题：千问 API 连接失败

**可能原因：**
- API 服务器地址不可访问
- API 密钥无效

**解决方案：**
1. 检查网络连接，确保能访问 `http://cloud.tanheidc.cn:9998`
2. 验证 API 密钥是否正确
3. 查看后端日志获取详细错误信息

### 问题：模型列表不显示

**可能原因：**
- `librechat.yaml` 配置有语法错误
- `fetch: false` 确保使用预定义的模型列表

**解决方案：**
1. 检查 YAML 缩进是否正确（使用空格，不要用 Tab）
2. 确保 `fetch: false` 配置正确
3. 查看服务器启动日志是否有 YAML 解析错误

## 参考文档

- [千问LLM配置指南](./千问LLM配置指南.md) - 详细的千问配置说明
- [LibreChat 官方文档](https://www.librechat.ai/docs) - LibreChat 完整文档

---

更新时间：2026-01-28
